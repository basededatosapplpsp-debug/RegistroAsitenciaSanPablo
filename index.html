<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0b5fff" />
  <meta name="description" content="Registro de asistencia de docentes con validación por ubicación." />

  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="icon" sizes="32x32" href="favicon-32.png" />
  <link rel="icon" sizes="16x16" href="favicon-16.png" />
  <link rel="apple-touch-icon" href="apple-touch-icon.png" />

  <title>Asistencia Docentes</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header class="header">
    <div>
      <h1>Asistencia Docentes</h1>
      <p class="sub">Entrada / salida con validación por ubicación</p>
    </div>

    <div class="header-actions">
      <button id="btnRefreshSW" class="btn btn-ghost" title="Borrar caché y actualizar">Actualizar</button>
      <button id="btnInstall" class="btn btn-ghost" hidden>Instalar</button>
    </div>
  </header>

  <main class="container">
    <!-- ===== Registrar ===== -->
    <section class="card">
      <h2>Registrar</h2>

      <label class="label" for="teacherName">Nombre del docente</label>
      <input id="teacherName" class="input" type="text" placeholder="Ej: Ana Pérez" autocomplete="name" />

      <div class="row">
        <button id="btnEntrada" class="btn btn-primary">Registrar ENTRADA</button>
        <button id="btnSalida" class="btn btn-secondary">Registrar SALIDA</button>
      </div>

      <div class="status" id="status">
        <span class="dot" id="dot"></span>
        <div>
          <div id="statusTitle">Listo</div>
          <div class="muted" id="statusMsg">Activa ubicación para registrar en el colegio.</div>
        </div>
      </div>

      <details class="details">
        <summary>Verificación de ubicación</summary>
        <div class="kv">
          <div><span class="k">Distancia:</span> <span id="dist">—</span></div>
          <div><span class="k">Precisión:</span> <span id="acc">—</span></div>
          <div><span class="k">Coordenadas:</span> <span id="coords">—</span></div>
        </div>
      </details>
    </section>

    <!-- ===== Registros: tarjeta grande (botón) ===== -->
    <section class="card card-action">
      <button id="btnToggleRecords" class="card-button" type="button" aria-expanded="false" aria-controls="recordsPanel">
        <div class="card-button-text">
          <div class="card-title">Registros</div>
          <div class="muted small">Ver historial de entradas y salidas</div>
        </div>
        <span class="chevron" aria-hidden="true">›</span>
      </button>
    </section>

    <!-- ===== Panel de registros (colapsable) ===== -->
    <section class="card collapse" id="recordsPanel" hidden>
      <div class="row">
        <button id="btnExport" class="btn btn-ghost">Exportar CSV</button>
        <button id="btnClear" class="btn btn-danger">Borrar todo</button>
      </div>

      <!-- LISTA MOBILE -->
      <div id="recordsList" class="records-list"></div>

      <!-- TABLA DESKTOP -->
      <div class="table-wrap desktop-only">
        <table class="table" aria-label="Registros de asistencia">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Hora</th>
              <th>Docente</th>
              <th>Tipo</th>
              <th>Dist</th>
              <th>Prec</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>

      <p class="muted small">
        Nota: Los registros se guardan localmente en el celular (LocalStorage).
      </p>
    </section>
  </main>

  <footer class="footer">
    <span class="muted small">PWA • funciona offline (cache) • requiere HTTPS</span>
  </footer>

  <script src="app.js" defer></script>

<!-- ======= MODAL LOGIN ======= -->
<div id="loginModal" class="modal-backdrop" hidden>
  <div class="modal-card">
    <h2 class="modal-title">Iniciar sesión</h2>
    <p class="modal-sub">Registra tus datos una sola vez en este teléfono.</p>

    <label class="modal-label">Nombre</label>
    <input id="loginName" class="modal-input" type="text" placeholder="Ej: Deimer Herrera" />

    <label class="modal-label">Correo</label>
    <input id="loginEmail" class="modal-input" type="email" placeholder="Ej: profesor@colegio.edu.co" />

    <label class="modal-label">Curso (Director de grupo)</label>
    <input id="loginCourse" class="modal-input" type="text" placeholder="Ej: 7A" />

    <div class="device-box">
  <div class="device-row">
    <span class="muted small">ID del teléfono (para autorizar):</span>
    <button id="btnCopyDevice" type="button" class="btn btn-ghost small">Copiar</button>
  </div>
  <div id="deviceIdText" class="device-id"></div>
</div>


<div class="modal-actions">
  <button id="btnLoginSave" type="button" class="btn btn-primary">Guardar</button>
  <button id="btnRequestAuth" type="button" class="btn btn-ghost">Solicitar autorización</button>
</div>



    <div id="loginHint" class="modal-hint muted small"></div>
  </div>
</div>


</body>
</html>
